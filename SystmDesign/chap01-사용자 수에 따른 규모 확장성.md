# 사용자 수에 따른 규모 확장성 
단일 서버부터 시작하여 조금씩 규모를 확장해나가는 스토리 

## 단일 서버 및 사용자 요청 처리 흐름 
- 모든 컴포넌트에 대해서 단 한 대의 서버에서 실행된다. 
- 웹 앱, DB, Cache 등 전부 서버 한 대에서 실행될 때

### 사용자 요청 처리 기본 흐름 
1. 사용자(웹 앱/ 모바일 앱)가 도메인을 이용해 웹 사이트에 접속을 위해 해당 주소를 DNS 서버로 질의 
2. DNS 조회 결과로 반환된 IP주소를 HTTP로 전달됨
3. 요청을 받은 웹 서버는 HTML / JSON 형태의 response 반환 


## DB 
- 사용자가 늘어나게되면 단일 서버로는 커버할 수 없어 여러 서버를 두어야함 
- 웹/모바일 트래픽 처리와 데이터 처리에 대해 서버를 각각 분리(트래픽 처리 서버 / DB 서버)

### DB 종류 
RDBMS 
- MySQL, Oracle DB, PostgreSQL 
- SQL을 통해 여러 테이블에 있는 데이터를 관계에 따라 Join 가능 

No-SQL
- CouchDB, DynamoDB, MongoDB, Elasticsearch 
- 일반적으로 Join 연산 지원 X
- 분류 
  - key-value 저장소 (KVS)
  - Graph 저장소
  - Column 저장소
  - Document 저장소 

> 비관계형 데이터베이스가 적합한 경우
> - 낮은 latency가 요구될 때
> - 다루는 데이터가 비정형이라 관계형 데이터가 아닐 떄 
> - 데이터(Json, yaml, XML 등)를 직렬화하거나 역직렬화만 할 수 있으면 될 떄 
> - 아주 많은 양의 데이터를 저장할 필요가 있을 떄 

## Scale-UP / Scale-Out

### Scalue-Up
- 수직적 규모 확장
- 서버에 고사양 자원을 추가하는 행위 
- 유입되는 트래픽의 양이 적을 떄 
- 단순함이 가장 큰 장점 
- 단점 
  - 한 대의 서버에 CPU / 메모리를 무한대로 증설할 수 없음 
  - 장애에 대한 자동복구 방안 다중화 방안이 X 

### Scale-Out 
- 수평적 규모 확장 
- 더 많은 서버를 추가해 성능을 개선
- 대규모 애플리케이션을 지원하는데 적절


## LoadBalancer 
- 부하 분산 집합에 속한 웹 서버들에게 트래픽 부하 분산
- 사용자는 로드밸런스의 public Ip를 통해 접속 / 웹 서버가 직접 클라이언트의 접속을 처리하지 않는다. 
- 보안을 위해 서버간 통신에는 public IP가 사용된다. (loadBalancer - private Ip - Server)

### 장점
- 장애를 자동 복구하지 못하던 기존의 문제해결 
  - 트래픽 부하 처리 / 서버 다운 시 문제 해결 
- 웹 계층의 가용성 향상 
  - 서버 증설 시 우아한 대처 
  - 로드밸런서가 자동으로 트래픽 분산 

## DB 다중화 
- 보통 master-slave 관계 설정 
- 데이터 원본은 master / replica - slave
- master 는 보통 write 연산 / slave 는 읽기 연산만 가능 
- 어플리케이션의 읽기 query 의 비중이 높기 떄문에 slave db의 수가 더욱 많음 

### 더 나은 성능 
- 모든 데이터 변경 연산은 마스터로만 전달, 읽기 연산은 slave 서버들로 분산
- 병렬로 처리될 수 있는 질의 수가 늘어나므로 성능이 좋아진다. 

### 안전성 
- DB 서버 중 일부 서버가 다운되어도 데이터 보존 가능 
- 데이터를 지역적으로 떨어진 여러 장소에 다중화 처리 

### 가용성 
- 읽기 연산은 나머지 슬레이브 서버로 분산되어, 새로운 슬레이브 서버가 장애 서버를 대체한다. 


